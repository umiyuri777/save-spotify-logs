# Spotify ãƒ­ã‚°åˆ†æã‚¢ãƒ—ãƒª

GitHub Pagesã§ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã§ãã‚‹Spotifyãƒ­ã‚°åˆ†æã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚Supabaseã‹ã‚‰ç›´æ¥ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã€æ¥½æ›²ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã¨ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåˆ†å¸ƒã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

## æ©Ÿèƒ½

- ğŸµ **æ¥½æ›²ãƒ©ãƒ³ã‚­ãƒ³ã‚°**: å†ç”Ÿå›æ•°ãŒå¤šã„æ¥½æ›²ã®ãƒˆãƒƒãƒ—20ã‚’è¡¨ç¤º
- ğŸ¨ **ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåˆ†å¸ƒ**: å††ã‚°ãƒ©ãƒ•ã¨ãƒªã‚¹ãƒˆã§ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåˆ¥ã®å†ç”Ÿå‰²åˆã‚’è¡¨ç¤º
- ğŸ“Š **çµ±è¨ˆæƒ…å ±**: ç·å†ç”Ÿå›æ•°ã€ãƒ¦ãƒ‹ãƒ¼ã‚¯æ›²æ•°ã€ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆæ•°ã€ç·å†ç”Ÿæ™‚é–“ã‚’è¡¨ç¤º
- ğŸ”— **Spotifyé€£æº**: æ¥½æ›²ã‚’ç›´æ¥Spotifyã§å†ç”Ÿå¯èƒ½
- ğŸ“± **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³**: ãƒ¢ãƒã‚¤ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã§ã‚‚å¿«é©ã«è¡¨ç¤º

## ä½¿ç”¨æ–¹æ³•

### 1. Supabaseã®è¨­å®š

1. Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
2. æä¾›ã•ã‚ŒãŸSQLã‚¹ã‚­ãƒ¼ãƒã§ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ãƒ“ãƒ¥ãƒ¼ã‚’ä½œæˆ
3. Supabase URLã¨Anon Keyã‚’å–å¾—

### 2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½¿ç”¨

1. ãƒšãƒ¼ã‚¸ã‚’é–‹ã
2. Supabaseè¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ä»¥ä¸‹ã‚’å…¥åŠ›ï¼š
   - **Supabase URL**: `https://your-project.supabase.co`
   - **Supabase Anon Key**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åŒ¿åã‚­ãƒ¼
3. ã€Œæ¥ç¶šã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
4. ãƒ‡ãƒ¼ã‚¿ãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã¨ã€çµ±è¨ˆæƒ…å ±ã¨ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™

### 3. GitHub Pagesã§ã®ãƒ‡ãƒ—ãƒ­ã‚¤

1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. GitHub Pagesã‚’æœ‰åŠ¹åŒ–
3. `index.html`ã€`app.js`ã€`style.css`ã‚’ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®
4. è¨­å®šã¯å®Œäº†ã§ã™ï¼

## å¿…è¦ãªSupabaseã‚¹ã‚­ãƒ¼ãƒ

ä»¥ä¸‹ã®SQLã‚’Supabaseã§å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼š

```sql
-- Spotify ãƒ­ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ
CREATE TABLE spotify_logs (
    id BIGSERIAL PRIMARY KEY,
    track_name VARCHAR(255) NOT NULL,
    artist_name VARCHAR(255) NOT NULL,
    played_at TIMESTAMPTZ NOT NULL,
    saved_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
    track_id VARCHAR(50) NOT NULL,
    artist_id VARCHAR(50) NOT NULL,
    album_name VARCHAR(255) NOT NULL,
    album_id VARCHAR(50) NOT NULL,
    duration_ms INTEGER NOT NULL,
    popularity INTEGER,
    external_urls JSONB,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä½œæˆ
CREATE INDEX idx_spotify_logs_track_id ON spotify_logs(track_id);
CREATE INDEX idx_spotify_logs_artist_id ON spotify_logs(artist_id);
CREATE INDEX idx_spotify_logs_played_at ON spotify_logs(played_at);
CREATE INDEX idx_spotify_logs_artist_name ON spotify_logs(artist_name);
CREATE INDEX idx_spotify_logs_track_name ON spotify_logs(track_name);

-- è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
CREATE INDEX idx_spotify_logs_track_artist ON spotify_logs(track_name, artist_name);
CREATE INDEX idx_spotify_logs_played_at_desc ON spotify_logs(played_at DESC);

-- RLSã®è¨­å®š
ALTER TABLE spotify_logs ENABLE ROW LEVEL SECURITY;

-- ãƒãƒªã‚·ãƒ¼ã®ä½œæˆ
CREATE POLICY "Allow read access for all users" ON spotify_logs
    FOR SELECT USING (true);

CREATE POLICY "Allow insert for authenticated users" ON spotify_logs
    FOR INSERT WITH CHECK (auth.role() = 'authenticated');

-- çµ±è¨ˆæƒ…å ±ç”¨ã®ãƒ“ãƒ¥ãƒ¼
CREATE VIEW spotify_stats AS
SELECT 
    COUNT(*) as total_plays,
    COUNT(DISTINCT track_id) as unique_tracks,
    COUNT(DISTINCT artist_id) as unique_artists,
    COUNT(DISTINCT album_id) as unique_albums,
    SUM(duration_ms) as total_duration_ms,
    AVG(popularity) as avg_popularity
FROM spotify_logs;

-- äººæ°—æ›²ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç”¨ã®ãƒ“ãƒ¥ãƒ¼
CREATE VIEW track_ranking AS
SELECT 
    track_name,
    artist_name,
    album_name,
    COUNT(*) as play_count,
    AVG(popularity) as avg_popularity,
    SUM(duration_ms) as total_duration_ms,
    MAX(played_at) as last_played,
    external_urls
FROM spotify_logs
GROUP BY track_name, artist_name, album_name, external_urls
ORDER BY play_count DESC;

-- ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåˆ†å¸ƒç”¨ã®ãƒ“ãƒ¥ãƒ¼
CREATE VIEW artist_distribution AS
SELECT 
    artist_name,
    artist_id,
    COUNT(*) as play_count,
    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER(), 2) as percentage,
    COUNT(DISTINCT track_id) as unique_tracks,
    SUM(duration_ms) as total_duration_ms
FROM spotify_logs
GROUP BY artist_name, artist_id
ORDER BY play_count DESC;
```

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
â”œâ”€â”€ index.html          # ãƒ¡ã‚¤ãƒ³HTMLãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ app.js             # JavaScriptã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ style.css          # CSSã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ
â””â”€â”€ README.md          # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: HTML5, CSS3, JavaScript (ES6+)
- **UI ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Bootstrap 5
- **ãƒãƒ£ãƒ¼ãƒˆ**: Chart.js
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: Supabase (PostgreSQL)
- **ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°**: GitHub Pages

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- Supabaseã®RLSï¼ˆRow Level Securityï¼‰ã‚’ä½¿ç”¨
- åŒ¿åã‚­ãƒ¼ã¯èª­ã¿å–ã‚Šå°‚ç”¨ã‚¢ã‚¯ã‚»ã‚¹
- è¨­å®šæƒ…å ±ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶å†…ã®ã¿ï¼‰

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

## ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€GitHubã®Issuesã§å ±å‘Šã—ã¦ãã ã•ã„ã€‚